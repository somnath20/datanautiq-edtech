<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard | DataNautIQ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f5f7fb;
    }

    header {
      background: #0b5cff;
      color: white;
      padding: 16px 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .container {
      max-width: 900px;
      margin: 30px auto;
      padding: 0 20px;
    }

    .card {
      background: white;
      border-radius: 10px;
      padding: 22px;
      margin-bottom: 24px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
    }

    .user {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .avatar {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background: #ccc;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 26px;
      color: white;
      font-weight: bold;
      overflow: hidden;
    }

    .avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    button {
      background: #ff4d4f;
      color: white;
      border: none;
      padding: 10px 18px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }

    button:hover {
      opacity: 0.9;
    }

    .primary-btn {
      background: #0b5cff;
      margin-top: 12px;
    }

    ul {
      padding-left: 20px;
    }

    li {
      margin-bottom: 6px;
    }
  </style>
</head>

<body>

<!-- HEADER -->
<header>
  <h2>DataNautIQ Dashboard</h2>
  <button id="logoutBtn">Logout</button>
</header>

<!-- CONTENT -->
<div class="container">

  <!-- USER CARD -->
  <div class="card user">
    <div class="avatar" id="avatar">
      <span id="avatarLetter">U</span>
      <img id="userPhoto" style="display:none;" />
    </div>

    <div>
      <h3 id="userName">Loading...</h3>
      <p id="userEmail" style="color:#666;"></p>
    </div>
  </div>

  <!-- NAVBAR -->
<nav class="bg-white shadow-md px-6 py-4 flex justify-between items-center sticky top-0 z-50">
  <h1 class="text-2xl font-bold text-blue-600">
    <a href="index.html">DataNautIQ</a>
  </h1>

  <ul class="flex items-center space-x-6">

    <li><a class="nav-link" href="index.html">Home</a></li>
    <li><a class="nav-link" href="live-courses.html">Live Courses</a></li>
    <li><a class="nav-link" href="courses.html">All Courses</a></li>
    <li><a class="nav-link" href="blogs.html">Blogs</a></li>
    <li><a class="nav-link" href="feedback.html">Feedback</a></li>
    <li><a class="nav-link" href="contact.html">Contact</a></li>

    <!-- DASHBOARD (logged in only) -->
    <li id="dashboardNav" class="hidden">
      <a class="nav-link font-semibold text-blue-600" href="dashboard.html">
        Dashboard
      </a>
    </li>

    <!-- LOGIN (logged out only) -->
    <li id="loginNav">
      <a class="nav-link font-semibold text-blue-600" href="login.html">
        Login
      </a>
    </li>

    <!-- USER AVATAR -->
    <li id="userNav" class="hidden flex items-center gap-3">
      <img id="userAvatar"
           src=""
           alt="User"
           title="Dashboard"
           class="w-8 h-8 rounded-full cursor-pointer" />

      <button id="logoutLink"
              class="text-red-500 font-medium hover:underline">
        Logout
      </button>
    </li>

  </ul>
</nav>


  <!-- ACCESS -->
  <div class="card">
    <h3>Your Access</h3>
    <ul>
      <li>‚úÖ Courses Dashboard</li>
      <li>‚úÖ Live Sessions</li>
      <li>‚úÖ Learning Resources</li>
    </ul>
  </div>

  <!-- FEEDBACK (IMPORTANT) -->
  <div class="card" style="border-left: 6px solid #0b5cff;">
    <h3>üìù Course Feedback</h3>
    <p>
      Your feedback helps us improve content quality and learning experience.
      It takes less than 2 minutes.
    </p>

    <button class="primary-btn" onclick="window.location.href='feedback.html'">
      Give Feedback
    </button>
  </div>

  <!-- NEXT STEPS -->
  <div class="card">
    <h3>Next Steps</h3>
    <p>
      You are successfully logged in using Google.
      This dashboard is protected and visible only to authenticated users.
    </p>
  </div>

</div>

<!-- AUTH LOGIC -->
<script type="module">
  import { onAuthStateChanged, signOut }
    from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
  import { auth } from "./assets/js/firebase.js";

  const userName = document.getElementById("userName");
  const userEmail = document.getElementById("userEmail");
  const userPhoto = document.getElementById("userPhoto");
  const avatarLetter = document.getElementById("avatarLetter");
  const logoutBtn = document.getElementById("logoutBtn");

  // üîê AUTH GUARD
  onAuthStateChanged(auth, user => {
    if (!user) {
      window.location.href = "login.html";
      return;
    }

    userName.innerText = user.displayName || "User";
    userEmail.innerText = user.email;

    // Avatar handling
    if (user.photoURL) {
      userPhoto.src = user.photoURL;
      userPhoto.style.display = "block";
      avatarLetter.style.display = "none";
    } else {
      avatarLetter.innerText = (user.displayName || "U")[0].toUpperCase();
    }
  });

  // üö™ LOGOUT
  logoutBtn.addEventListener("click", () => {
    signOut(auth)
      .then(() => window.location.href = "login.html")
      .catch(err => alert(err.message));
  });
</script>

</body>
</html>
